{"version":3,"names":["useEffect","useMemo","WorkletsProxy","SkiaProxy","withFrameRefCounting","VisionCameraProxy","getRotationDegrees","orientation","Error","getPortraitSize","frame","width","height","createSkiaFrameProcessor","frameProcessor","surfaceHolder","offscreenTextures","Skia","Worklets","getSkiaSurface","_surfaceHolder$value$","_surfaceHolder$value$2","_surfaceHolder$value$4","threadId","getCurrentThreadId","size","value","_surfaceHolder$value$3","surface","Surface","MakeOffscreen","dispose","createDrawableProxy","canvas","nativeBuffer","getNativeBuffer","image","Image","MakeImageFromNativeBuffer","pointer","canvasProxy","Proxy","get","_","property","paint","save","rotation","rotate","drawImage","restore","delete","withBaseClass","getCanvas","drawableFrame","black","Color","clear","flush","snapshot","makeImageSnapshot","snapshotCopy","makeNonTextureImage","push","length","texture","shift","type","useSkiaFrameProcessor","dependencies","useSharedValue","_VisionCameraProxy$wo","workletContext","runAsync","surfaces","Object","values","map","v","forEach","s"],"sourceRoot":"../../../src","sources":["skia/useSkiaFrameProcessor.ts"],"mappings":"AAEA,SAASA,SAAS,EAAEC,OAAO,QAAQ,OAAO;AAI1C,SAASC,aAAa,QAAQ,+BAA+B;AAE7D,SAASC,SAAS,QAAQ,2BAA2B;AACrD,SAASC,oBAAoB,QAAQ,0CAA0C;AAC/E,SAASC,iBAAiB,QAAQ,uCAAuC;;AAEzE;AACA;AACA;AACA;AACA;AACA;;AAsBA,SAASC,kBAAkBA,CAACC,WAAwB,EAAU;EAC5D,SAAS;;EACT,QAAQA,WAAW;IACjB,KAAK,UAAU;MACb,OAAO,CAAC;IACV,KAAK,gBAAgB;MACnB,OAAO,EAAE;IACX,KAAK,sBAAsB;MACzB,OAAO,GAAG;IACZ,KAAK,iBAAiB;MACpB,OAAO,GAAG;IACZ;MACE,MAAM,IAAIC,KAAK,CAAE,kCAAiCD,WAAY,GAAE,CAAC;EACrE;AACF;AAEA,SAASE,eAAeA,CAACC,KAAY,EAAqC;EACxE,SAAS;;EACT,IAAIA,KAAK,CAACH,WAAW,KAAK,gBAAgB,IAAIG,KAAK,CAACH,WAAW,KAAK,iBAAiB,EAAE;IACrF;IACA,OAAO;MAAEI,KAAK,EAAED,KAAK,CAACE,MAAM;MAAEA,MAAM,EAAEF,KAAK,CAACC;IAAM,CAAC;EACrD,CAAC,MAAM;IACL;IACA,OAAO;MAAEA,KAAK,EAAED,KAAK,CAACC,KAAK;MAAEC,MAAM,EAAEF,KAAK,CAACE;IAAO,CAAC;EACrD;AACF;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,wBAAwBA,CACtCC,cAA8C,EAC9CC,aAAyC,EACzCC,iBAA0C,EAClB;EACxB,MAAMC,IAAI,GAAGd,SAAS,CAACc,IAAI;EAC3B,MAAMC,QAAQ,GAAGhB,aAAa,CAACgB,QAAQ;EAEvC,MAAMC,cAAc,GAAIT,KAAY,IAAgB;IAClD,SAAS;;IAET;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAAA,IAAAU,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA;IACA,MAAMC,QAAQ,GAAGL,QAAQ,CAACM,kBAAkB,CAAC,CAAC;IAC9C,MAAMC,IAAI,GAAGhB,eAAe,CAACC,KAAK,CAAC;IACnC,IACEK,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,IAAI,IAAI,IACrC,EAAAH,qBAAA,GAAAL,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,cAAAH,qBAAA,uBAA7BA,qBAAA,CAA+BT,KAAK,MAAKc,IAAI,CAACd,KAAK,IACnD,EAAAU,sBAAA,GAAAN,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,cAAAF,sBAAA,uBAA7BA,sBAAA,CAA+BT,MAAM,MAAKa,IAAI,CAACb,MAAM,EACrD;MAAA,IAAAe,sBAAA;MACA,MAAMC,OAAO,GAAGX,IAAI,CAACY,OAAO,CAACC,aAAa,CAACL,IAAI,CAACd,KAAK,EAAEc,IAAI,CAACb,MAAM,CAAC;MACnE,IAAIgB,OAAO,IAAI,IAAI,EAAE;QACnB;QACA,MAAM,IAAIpB,KAAK,CAAE,oBAAmBiB,IAAI,CAACd,KAAM,IAAGc,IAAI,CAACb,MAAO,gBAAe,CAAC;MAChF;MACA,CAAAe,sBAAA,GAAAZ,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,cAAAI,sBAAA,eAA7BA,sBAAA,CAA+BC,OAAO,CAACG,OAAO,CAAC,CAAC;MAChDhB,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,GAAG;QAAEK,OAAO,EAAEA,OAAO;QAAEjB,KAAK,EAAEc,IAAI,CAACd,KAAK;QAAEC,MAAM,EAAEa,IAAI,CAACb;MAAO,CAAC;IAC9F;IACA,MAAMgB,OAAO,IAAAN,sBAAA,GAAGP,aAAa,CAACW,KAAK,CAACH,QAAQ,CAAC,cAAAD,sBAAA,uBAA7BA,sBAAA,CAA+BM,OAAO;IACtD,IAAIA,OAAO,IAAI,IAAI,EAAE,MAAM,IAAIpB,KAAK,CAAE,8CAA6Ce,QAAS,EAAC,CAAC;IAC9F,OAAOK,OAAO;EAChB,CAAC;EAED,MAAMI,mBAAmB,GAAGA,CAACtB,KAAY,EAAEuB,MAAgB,KAAoB;IAC7E,SAAS;;IAET;IACA,MAAMC,YAAY,GAAIxB,KAAK,CAAmByB,eAAe,CAAC,CAAC;IAC/D,MAAMC,KAAK,GAAGnB,IAAI,CAACoB,KAAK,CAACC,yBAAyB,CAACJ,YAAY,CAACK,OAAO,CAAC;;IAExE;IACA,MAAMC,WAAW,GAAG,IAAIC,KAAK,CAACR,MAAM,EAAoB;MACtDS,GAAGA,CAACC,CAAC,EAAEC,QAA8B,EAAE;QACrC,QAAQA,QAAQ;UACd,KAAK,WAAW;YACd,OAAOR,KAAK;UACd,KAAK,QAAQ;YACX,OAAQS,KAAe,IAAK;cAC1B,SAAS;;cACT;cACAZ,MAAM,CAACa,IAAI,CAAC,CAAC;cACb,MAAMC,QAAQ,GAAGzC,kBAAkB,CAACI,KAAK,CAACH,WAAW,CAAC;cACtD0B,MAAM,CAACe,MAAM,CAACD,QAAQ,EAAErC,KAAK,CAACC,KAAK,GAAG,CAAC,EAAED,KAAK,CAACE,MAAM,GAAG,CAAC,CAAC;cAC1D;cACA,IAAIiC,KAAK,IAAI,IAAI,EAAEZ,MAAM,CAACgB,SAAS,CAACb,KAAK,EAAE,CAAC,EAAE,CAAC,EAAES,KAAK,CAAC,MAClDZ,MAAM,CAACgB,SAAS,CAACb,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;;cAElC;cACAH,MAAM,CAACiB,OAAO,CAAC,CAAC;YAClB,CAAC;UACH,KAAK,SAAS;YACZ,OAAO,MAAM;cACX,SAAS;;cACT;cACAd,KAAK,CAACL,OAAO,CAAC,CAAC;cACfG,YAAY,CAACiB,MAAM,CAAC,CAAC;YACvB,CAAC;QACL;QACA,OAAOlB,MAAM,CAACW,QAAQ,CAAC;MACzB;IACF,CAAC,CAAC;IAEF,OAAQlC,KAAK,CAAmB0C,aAAa,CAACZ,WAAW,CAAC;EAC5D,CAAC;EAED,OAAO;IACL1B,cAAc,EAAEV,oBAAoB,CAAEM,KAAK,IAAK;MAC9C,SAAS;;MAET;MACA,MAAMkB,OAAO,GAAGT,cAAc,CAACT,KAAK,CAAC;;MAErC;MACA,MAAMuB,MAAM,GAAGL,OAAO,CAACyB,SAAS,CAAC,CAAC;MAClC,MAAMC,aAAa,GAAGtB,mBAAmB,CAACtB,KAAK,EAAEuB,MAAM,CAAC;MAExD,IAAI;QACF;QACA,MAAMsB,KAAK,GAAGtC,IAAI,CAACuC,KAAK,CAAC,OAAO,CAAC;QACjCvB,MAAM,CAACwB,KAAK,CAACF,KAAK,CAAC;;QAEnB;QACAzC,cAAc,CAACwC,aAAa,CAAC;;QAE7B;QACA1B,OAAO,CAAC8B,KAAK,CAAC,CAAC;MACjB,CAAC,SAAS;QACR;QACAJ,aAAa,CAACvB,OAAO,CAAC,CAAC;MACzB;;MAEA;MACA,MAAM4B,QAAQ,GAAG/B,OAAO,CAACgC,iBAAiB,CAAC,CAAC;MAC5C,MAAMC,YAAY,GAAGF,QAAQ,CAACG,mBAAmB,CAAC,CAAC;MACnDH,QAAQ,CAAC5B,OAAO,CAAC,CAAC;MAClBf,iBAAiB,CAACU,KAAK,CAACqC,IAAI,CAACF,YAAY,CAAC;;MAE1C;MACA,OAAO7C,iBAAiB,CAACU,KAAK,CAACsC,MAAM,GAAG,CAAC,EAAE;QACzC;QACA,MAAMC,OAAO,GAAGjD,iBAAiB,CAACU,KAAK,CAACwC,KAAK,CAAC,CAAC;QAC/C,IAAID,OAAO,IAAI,IAAI,EAAE;QACrBA,OAAO,CAAClC,OAAO,CAAC,CAAC;MACnB;IACF,CAAC,CAAC;IACFoC,IAAI,EAAE,eAAe;IACrBnD,iBAAiB,EAAEA;EACrB,CAAC;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASoD,qBAAqBA,CACnCtD,cAA8C,EAC9CuD,YAA4B,EACJ;EACxB,MAAMzC,OAAO,GAAG1B,aAAa,CAACoE,cAAc,CAAe,CAAC,CAAC,CAAC;EAC9D,MAAMtD,iBAAiB,GAAGd,aAAa,CAACoE,cAAc,CAAY,EAAE,CAAC;EAErEtE,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MAAA,IAAAuE,qBAAA;MACX;MACA;MACA;MACA,CAAAA,qBAAA,GAAAlE,iBAAiB,CAACmE,cAAc,cAAAD,qBAAA,eAAhCA,qBAAA,CAAkCE,QAAQ,CAAC,MAAM;QAC/C,SAAS;;QACT,MAAMC,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAAChD,OAAO,CAACF,KAAK,CAAC,CAACmD,GAAG,CAAEC,CAAC,IAAKA,CAAC,CAAClD,OAAO,CAAC;QACnEA,OAAO,CAACF,KAAK,GAAG,CAAC,CAAC;QAClBgD,QAAQ,CAACK,OAAO,CAAEC,CAAC,IAAKA,CAAC,CAACjD,OAAO,CAAC,CAAC,CAAC;QACpC,OAAOf,iBAAiB,CAACU,KAAK,CAACsC,MAAM,GAAG,CAAC,EAAE;UACzC,MAAMC,OAAO,GAAGjD,iBAAiB,CAACU,KAAK,CAACwC,KAAK,CAAC,CAAC;UAC/C,IAAID,OAAO,IAAI,IAAI,EAAE;UACrBA,OAAO,CAAClC,OAAO,CAAC,CAAC;QACnB;MACF,CAAC,CAAC;IACJ,CAAC;EACH,CAAC,EAAE,CAACf,iBAAiB,EAAEY,OAAO,CAAC,CAAC;EAEhC,OAAO3B,OAAO,CACZ,MAAMY,wBAAwB,CAACC,cAAc,EAAEc,OAAO,EAAEZ,iBAAiB,CAAC;EAC1E;EACAqD,YACF,CAAC;AACH"}